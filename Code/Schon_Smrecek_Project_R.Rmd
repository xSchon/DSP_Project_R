---
title: "Programovanie pre dátovú vedu: projekt 1"
output: html_notebook
---

# Zadanie

* Stručne predstavte dáta pomocou SQL-LIKE syntaxe a grafiky „grammar of graphics“. Môžete uviesť počet záznamov, počet atribútov, ich typy a charakteristiky ktoré sú potrebné k tomu, aby ste dokázali vašu hypotézu. Sú pôvodné atribúty použiteľné, alebo je nutné niektoré transformovať na nové ? (napríklad ak mám vzdialenosť a čas, môžem si vypočítať rýchlosť a tú použiť pre ďalšiu fázu), majú dáta hodnoty, ktoré významne vybočujú z priemeru? Má dátaset chýbajúce hodnoty? Ako s nimi budete zaobchádzať? Prečo?
* V treťom kroku si stanovte jednu hypotézu, ktoré je overiteľná lineárnym regresným modelom a potvrďte ju pomocou krížovej validácie vstupných dát. Pri programovaní nepoužívajte cykly a špeciálne sa zamerajte na centrálne tendencie a rozptyl parametrov β1 a β2.

# Načítanie knižníc a datasetu

```{r}
library(tidyverse)
library(patchwork)
#library(readxl)
```

```{r}
wages <- read_csv("Wages.csv")
#wages <- read_excel("Wages.xls", sheet = "WAGE2")
```
# Charakteristika dát

## Názvy stĺpcov
```{r}
data.frame(colnames(wages))
```

## Ukážka dát v datasete
```{r}
head(wages, 10)
```
## Počet riadkov, stĺpcov a typy stĺpcov
```{r}
nrow(wages)
ncol(wages)
spec(wages)
```
## Význam stĺpcov
  1. wage                     monthly earnings
  2. hours                    average weekly hours
  3. IQ                       IQ score
  4. KWW                      knowledge of world work score
  5. educ                     years of education
  6. exper                    years of work experience
  7. tenure                   years with current employer
  8. age                      age in years
  9. married                  =1 if married
 10. black                    =1 if black
 11. south                    =1 if live in south
 12. urban                    =1 if live in SMSA
 13. sibs                     number of siblings
 14. brthord                  birth order
 15. meduc                    mother's education
 16. feduc                    father's education
 17. lwage                    natural log of wage

## Ošetrenie chýbajúcich hodnôt
V pôvodnom datasete boli chýbajúce hodnoty reprezentované bodkami, pre jednoduchšiu prácu sme bodky nahradili NA.
```{r}
wages[wages == "."] <- NA
wages
```
```{r}
sum(is.na(wages))
na_count <-sapply(wages, function(x) sum(is.na(x)))
na_count <- data.frame(na_count)
na_count
```
Chýbajúcich hodnôt je 355 a aj to len v stĺpcoch birth order, mother's education a father's education. Tieto chýbajúce hodnoty by nemali ovplyvňovať naše hypotézy.

## Základné charakteristiky dát

### wage
```{r}
summary(wages$wage)

wage_hist <- ggplot(wages) + ggtitle("Histogram of wage") + aes(x = wage) + geom_histogram() + theme_minimal()

wage_box <- ggplot(wages) + ggtitle("Boxplot of wage") + aes(x = "", y = wage) + geom_boxplot() + theme_minimal()

wage_hist + wage_box

```


### hours
```{r}
summary(wages$hours)

hours_hist <- ggplot(wages) + ggtitle("Histogram of hours") + aes(x = hours) + geom_histogram() + theme_minimal()

hours_box <- ggplot(wages) + ggtitle("Boxplot of hours") + aes(x = "", y = hours) + geom_boxplot() + theme_minimal()

hours_hist + hours_box
```

### IQ
```{r}
summary(wages$IQ)

iq_hist <- ggplot(wages) + ggtitle("Histogram of IQ") + aes(x = IQ) + geom_histogram() + theme_minimal()

iq_box <- ggplot(wages) + ggtitle("Boxplot of IQ") + aes(x = "", y = IQ) + geom_boxplot() + theme_minimal()

iq_hist + iq_box
```

### KWW
```{r}
summary(wages$KWW)

kww_hist <- ggplot(wages) + ggtitle("Histogram of KWW") + aes(x = KWW) + geom_histogram() + theme_minimal()

kww_box <- ggplot(wages) + ggtitle("Boxplot of KWW") + aes(x = "", y = KWW) + geom_boxplot() + theme_minimal()

kww_hist + kww_box
```

### educ
```{r}
summary(wages$educ)

educ_hist <- ggplot(wages) + ggtitle("Histogram of educ") + aes(x = educ) + geom_histogram() + theme_minimal()

educ_box <- ggplot(wages) + ggtitle("Boxplot of educ") + aes(x = "", y = educ) + geom_boxplot() + theme_minimal()

educ_hist + educ_box
```

### exper
```{r}
summary(wages$exper)

exper_hist <- ggplot(wages) + ggtitle("Histogram of exper") + aes(x = exper) + geom_histogram() + theme_minimal()

exper_box <- ggplot(wages) + ggtitle("Boxplot of exper") + aes(x = "", y = exper) + geom_boxplot() + theme_minimal()

exper_hist + exper_box
```

### tenure
```{r}
summary(wages$tenure)

tenure_hist <- ggplot(wages) + ggtitle("Histogram of tenure") + aes(x = tenure) + geom_histogram() + theme_minimal()

tenure_box <- ggplot(wages) + ggtitle("Boxplot of tenure") + aes(x = "", y = tenure) + geom_boxplot() + theme_minimal()

tenure_hist + tenure_box
```

### age
```{r}
summary(wages$age)

age_hist <- ggplot(wages) + ggtitle("Histogram of age") + aes(x = age) + geom_histogram() + theme_minimal()

age_box <- ggplot(wages) + ggtitle("Boxplot of age") + aes(x = "", y = age) + geom_boxplot() + theme_minimal()

age_hist + age_box
```

## Dáta, ktoré významne vybočujú z priemeru

Takéto dáta možno vidieť pri stĺpcoch wages, hours, IQ a KWW. Keďže sa jedná o skutočných ľudí.

## Tranformácia atribútov

Uvažujúc, že stĺpec wages znamená mesačný zárobok a stĺpec hours znamená priemerný odrobený počet hodín za týždeň, môžeme vypočítať hodinovú mzdu pracovníka, ako podiel mesačnej mzdy a štvornásobku priemeru počtu hodín odrobených za týždeň.

```{r}
wages <- wages %>% mutate(hour_wage = (wage / (hours * 4)))
wages %>% select(wage, hours, hour_wage, educ) %>% head(10)

hour_wage_hist <- ggplot(wages) + ggtitle("Histogram of hour_wage") + aes(x = hour_wage) + geom_histogram() + theme_minimal()

hour_wage_box <- ggplot(wages) + ggtitle("Boxplot of hour_wage") + aes(x = "", y = hour_wage) + geom_boxplot() + theme_minimal()

hour_wage_hist + hour_wage_box

identify_outliers <- function(a) {
    lower = quantile(a, 0.25, na.rm = TRUE) - 1.5 * IQR(a);
    upper = quantile(a, 0.75, na.rm = TRUE) + 1.5 * IQR(a);
    
    outliers <- a[(a > upper) | (a < lower)];
    #count(outliers)
    #order(outliers)
    outliers
}

identify_outliers(wages$hour_wage)

```
```{r}
lower = quantile(wages$hour_wage, 0.25, na.rm = TRUE) - 1.5 * IQR(wages$hour_wage);
upper = quantile(wages$hour_wage, 0.75, na.rm = TRUE) + 1.5 * IQR(wages$hour_wage);
    
standard <- wages[!(wages$hour_wage > upper) | (wages$hour_wage < lower), ]
standard

hour_wage_hist <- ggplot(standard) + ggtitle("Histogram of hour_wage") + aes(x = hour_wage) + geom_histogram() + theme_minimal()

hour_wage_box <- ggplot(standard) + ggtitle("Boxplot of hour_wage") + aes(x = "", y = hour_wage) + geom_boxplot() + theme_minimal()

hour_wage_hist + hour_wage_box
```


# Formulácia a štatistické overenie hypotéz

## Hypotézy

Existuje vzťah medzi výškou hodinovej mzdy a dĺžkou vzdelania?

$H_0$: Vzťah medzi výškou hodinovej mzdy a dĺžkou vzdelania **neexistuje**.

$H_1$: Vzťah medzi výškou hodinovej mzdy a dĺžkou vzdelania **existuje**.

## Lineárna regresia

```{r}
fit <- lm(hour_wage ~ educ, data = standard)
summary(fit)

#plot(fit, pch = 16, col = "blue")

ggplot(data = standard, aes(x = hour_wage, y = IQ)) + 
  geom_point(color='blue') +
  geom_smooth(method = "lm", se = FALSE)

```
```{r}

```


```{r}
sessionInfo()
```



